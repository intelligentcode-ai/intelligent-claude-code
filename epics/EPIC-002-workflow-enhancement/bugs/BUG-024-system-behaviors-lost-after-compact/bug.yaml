bug:
  id: "BUG-024"
  title: "System behaviors and workflow compliance lost after context compaction"
  type: "critical_system_failure"
  epic: "EPIC-002"
  created: "2025-07-17 17:15:00"
  created_by: "@PM"
  assigned_to: "@AI-Architect"
  priority: "P0"
  severity: "CRITICAL"
  status: "COMPLETED"
  phase: "DONE"
  completed: "2025-07-17 18:45:00"
  completed_by: "@PM"
  
problem_description: |
  CRITICAL SYSTEM FAILURE: After Claude Code context compaction, ALL behavioral
  aspects are lost including:
  - Workflow compliance (no story/task structure followed)
  - Sequential thinking (no structured analysis)
  - Learning application (previous learnings ignored)
  - Specialist roles (wrong assignments, no triage)
  - ID tracking (duplicate IDs created)
  - Process enforcement (jumps straight to implementation)
  - Quality gates (no reviews, no retrospectives)
  
  This is the ROOT CAUSE of repeated workflow violations and system failures.
  
root_cause: |
  Claude Code's context compaction removes behavioral system state, leaving
  only base Claude without the intelligent-claude-code enhancements. The
  system fails to restore behavioral patterns, workflow compliance, and
  process enforcement after compaction.
  
impact: |
  - Complete workflow breakdown after every context reset
  - Repeated violations of established processes
  - Loss of team learning and improvements
  - Duplication of work and ID conflicts
  - User frustration with constant re-education
  - System unreliability for production use
  
acceptance_criteria:
  - id: "AC-001"
    description: "Behavioral persistence mechanism implemented"
    validation_method: "integration_test"
    status: "pending"
    
  - id: "AC-002"
    description: "Workflow compliance survives context compaction"
    validation_method: "manual_test"
    status: "pending"
    
  - id: "AC-003"
    description: "Learning and memory integration maintained"
    validation_method: "manual_test"
    status: "pending"
    
  - id: "AC-004"
    description: "Specialist roles and triage persist"
    validation_method: "integration_test"
    status: "pending"
    
  - id: "AC-005"
    description: "Recovery commands restore full system state"
    validation_method: "manual_test"
    status: "pending"
    
definition_of_done:
  - "System behaviors persist across context compaction"
  - "Automatic recovery on context restoration"
  - "No manual re-education required"
  - "Full workflow compliance maintained"
  
# Embedded config drives task execution
embedded_config:
  autonomy_level: "L2"
  pm_always_active: true
  git_privacy: true
  blocking_enabled: true
  specialist_triage_required: true
  
# This is the most critical bug in the system
workflow:
  current_phase: "PLAN"
  approach: "behavioral_persistence"
  testing_required: true
  architect_review_required: true
  
# Tasks created with PM + AI-Architect triage
tasks:
  - id: "TASK-025"
    title: "Knowledge retrieval"
    type: "research"
    assigned_to: "@AI-Architect"
    estimated_hours: 1
    status: "planned"
    
  - id: "TASK-026"
    title: "Design persistence mechanism"
    type: "architecture"
    assigned_to: "@AI-Architect"
    estimated_hours: 3
    status: "planned"
    dependencies: ["TASK-025"]
    
  - id: "TASK-027"
    title: "Implement state preservation"
    type: "implementation"
    assigned_to: "@AI-Engineer"
    estimated_hours: 4
    status: "planned"
    dependencies: ["TASK-026"]
    
  - id: "TASK-028"
    title: "Create recovery commands"
    type: "implementation"
    assigned_to: "@AI-Engineer"
    estimated_hours: 3
    status: "planned"
    dependencies: ["TASK-027"]
    
  - id: "TASK-029"
    title: "Peer review"
    type: "review"
    assigned_to: "@AI-Architect"
    estimated_hours: 2
    status: "planned"
    dependencies: ["TASK-028"]
    
  - id: "TASK-030"
    title: "Test context recovery"
    type: "testing"
    assigned_to: "@QA-Engineer"
    estimated_hours: 3
    status: "planned"
    dependencies: ["TASK-029"]
    
  - id: "TASK-031"
    title: "Knowledge generation"
    type: "knowledge_creation"
    assigned_to: "@AI-Engineer"
    estimated_hours: 2
    status: "planned"
    dependencies: ["TASK-030"]