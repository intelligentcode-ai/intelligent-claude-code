# Git Clean

Clean git commit messages and content for privacy mode using $ARGUMENTS.

## Behavior
Strip AI mentions, co-authorship lines, and related content from git commits
when git_privacy mode is enabled. Ensures professional commit history
without AI collaboration traces.

## Arguments
**Format:** "Content: commit_message_or_content | Type: commit|pr_title|pr_description | Mode: strict|standard"
**Example:** "Content: Implement user auth with Claude's assistance ðŸ¤– | Type: commit | Mode: strict"

## Core Actions
- Parse content and cleaning type from $ARGUMENTS
- Check git_privacy setting from configuration
- Apply privacy cleaning rules based on type and mode
- Remove AI patterns with case-insensitive matching
- Clean orphaned phrases and normalize whitespace
- Ensure coherent message after cleaning
- Apply fallback message if content becomes empty
- Return cleaned content for git operations

## Privacy Cleaning Patterns

### Direct AI Mentions
- **AI References**: AI-generated, AI-assisted, AI assistant, AI-powered
- **Claude/Anthropic**: Claude, Anthropic, claude.ai
- **Generic AI**: artificial intelligence, machine learning assistant
- **AI Emojis**: ðŸ¤–, ðŸ§ , ðŸ”®, âš¡ (in AI context)
- **AI Brackets**: [AI], (AI), {AI}, <AI>

### Co-Authorship Lines
- "Co-Authored-By: Claude <*>"
- "Generated with Claude Code"
- "ðŸ¤– Generated with [Claude Code]"
- "Co-Authored-By: AI Assistant"
- "Pair programmed with Claude"

### Indirect References
- "automated assistant", "intelligent system"
- "virtual developer", "digital assistant"
- "AI pair programming", "AI collaboration"
- "machine-generated", "algorithmically created"

### Orphaned Phrases
- "with assistance from", "helped by"
- "pair programmed with", "generated by"
- "created using", "developed with"
- "in collaboration with", "supported by"

## Cleaning Modes

### Standard Mode
- Remove obvious AI mentions
- Clean co-authorship lines
- Remove AI emojis
- Preserve technical content

### Strict Mode
- All standard cleaning
- Remove indirect AI references
- Clean orphaned collaboration phrases
- Maximum privacy protection

## Content Types

### Commit Messages
- Clean subject line and body
- Preserve technical details
- Maintain commit message structure
- Apply appropriate fallback if empty

### PR/MR Titles
- Clean title text only
- Preserve technical keywords
- Maintain professional tone
- Ensure title remains descriptive

### PR/MR Descriptions
- Clean description content
- Remove co-authorship sections
- Preserve technical documentation
- Maintain markdown formatting

## Fallback Messages

### Commit Message Fallbacks
- "Update implementation" (general)
- "Fix issue" (for bug fixes)
- "Add feature" (for new features)
- "Refactor code" (for refactoring)
- "Update documentation" (for docs)

### PR/MR Title Fallbacks
- "Update [component]" (based on file changes)
- "Implement [feature]" (based on branch name)
- "Fix [issue]" (based on issue references)

## Branch Protection Integration
- Check branch_protection setting
- Validate target branch against protection rules
- Prevent direct commits to main/master when protected
- Suggest feature branch workflow
- Integrate with git workflow standards

## Cleaning Examples

### Before Cleaning
```
Implement OAuth authentication with Claude's assistance ðŸ¤–

Added JWT token validation and user session management.
Pair programmed with AI assistant for error handling.

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

### After Cleaning
```
Implement OAuth authentication

Added JWT token validation and user session management.
Included comprehensive error handling.
```

## Configuration Integration
- Activated when `git_privacy: true` in settings
- Respects configuration hierarchy (embedded > project > user > defaults)
- Cache cleaning rules for performance
- Log cleaning actions for transparency

## Quality Standards
- Preserve all technical content
- Maintain commit message readability
- Ensure meaningful commit history
- No loss of important project information
- Professional appearance in git logs

## Integration
- Used by git workflow commands
- Triggered during commit operations
- Integrates with PR/MR creation
- Supports batch cleaning for history rewrite
- Connected to git-privacy-enforcer.md behavior

## Error Handling
- Empty content after cleaning â†’ Apply appropriate fallback
- Invalid content type â†’ Return original with warning
- Configuration error â†’ Skip cleaning with notification
- Pattern matching error â†’ Log error, return original