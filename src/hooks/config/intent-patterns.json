{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Intent Pattern Configuration",
  "description": "Configuration for tool and pattern allowances by intent type",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Configuration schema version"
    },
    "intents": {
      "type": "object",
      "properties": {
        "research": {
          "type": "object",
          "description": "Reading, searching, analyzing - allowed in main scope",
          "properties": {
            "allowed_tools": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Tools permitted for research intent"
            },
            "blocked_tools": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Tools forbidden for research intent"
            },
            "parameter_patterns": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Regex patterns for allowed parameters"
                },
                "blocked": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Regex patterns for blocked parameters"
                }
              }
            },
            "path_patterns": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Regex patterns for allowed file paths"
                },
                "blocked": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Regex patterns for blocked file paths"
                }
              }
            },
            "context_requires": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Required context patterns"
            },
            "enforcement": {
              "type": "string",
              "enum": ["allow", "warn", "block", "require_prb_context"],
              "description": "How to enforce violations"
            }
          },
          "required": ["allowed_tools", "blocked_tools", "enforcement"]
        },
        "qa": {
          "type": "object",
          "description": "Answering questions, explaining - allowed in main scope",
          "properties": {
            "allowed_tools": { "$ref": "#/properties/intents/properties/research/properties/allowed_tools" },
            "blocked_tools": { "$ref": "#/properties/intents/properties/research/properties/blocked_tools" },
            "parameter_patterns": { "$ref": "#/properties/intents/properties/research/properties/parameter_patterns" },
            "path_patterns": { "$ref": "#/properties/intents/properties/research/properties/path_patterns" },
            "context_requires": { "$ref": "#/properties/intents/properties/research/properties/context_requires" },
            "enforcement": { "$ref": "#/properties/intents/properties/research/properties/enforcement" }
          },
          "required": ["allowed_tools", "blocked_tools", "enforcement"]
        },
        "planning": {
          "type": "object",
          "description": "Creating AgentTasks, architectural discussions - allowed in main scope",
          "properties": {
            "allowed_tools": { "$ref": "#/properties/intents/properties/research/properties/allowed_tools" },
            "blocked_tools": { "$ref": "#/properties/intents/properties/research/properties/blocked_tools" },
            "parameter_patterns": { "$ref": "#/properties/intents/properties/research/properties/parameter_patterns" },
            "path_patterns": { "$ref": "#/properties/intents/properties/research/properties/path_patterns" },
            "context_requires": { "$ref": "#/properties/intents/properties/research/properties/context_requires" },
            "enforcement": { "$ref": "#/properties/intents/properties/research/properties/enforcement" }
          },
          "required": ["allowed_tools", "blocked_tools", "enforcement"]
        },
        "work": {
          "type": "object",
          "description": "Implementing, fixing, modifying - blocked in main scope",
          "properties": {
            "allowed_tools": { "$ref": "#/properties/intents/properties/research/properties/allowed_tools" },
            "blocked_tools": { "$ref": "#/properties/intents/properties/research/properties/blocked_tools" },
            "parameter_patterns": { "$ref": "#/properties/intents/properties/research/properties/parameter_patterns" },
            "path_patterns": { "$ref": "#/properties/intents/properties/research/properties/path_patterns" },
            "context_requires": { "$ref": "#/properties/intents/properties/research/properties/context_requires" },
            "enforcement": { "$ref": "#/properties/intents/properties/research/properties/enforcement" }
          },
          "required": ["allowed_tools", "blocked_tools", "enforcement"]
        }
      },
      "required": ["research", "qa", "planning", "work"]
    },
    "defaults": {
      "type": "object",
      "description": "Default values when patterns don't match",
      "properties": {
        "enforcement": { "$ref": "#/properties/intents/properties/research/properties/enforcement" },
        "unknown_intent": {
          "type": "string",
          "enum": ["research", "qa", "planning", "work"],
          "description": "Default intent when classification is uncertain"
        }
      },
      "required": ["enforcement", "unknown_intent"]
    },
    "overrides": {
      "type": "object",
      "description": "Environment-specific configuration overrides",
      "properties": {
        "debug_mode": {
          "type": "boolean",
          "description": "Enable debug logging and relaxed enforcement"
        },
        "strict_mode": {
          "type": "boolean",
          "description": "Enable stricter enforcement and validation"
        }
      }
    }
  },
  "required": ["version", "intents", "defaults"],
  
  "data": {
    "version": "1.0.0",
    "intents": {
      "research": {
        "allowed_tools": [
          "Read",
          "Grep", 
          "Glob",
          "WebSearch",
          "WebFetch",
          "Bash"
        ],
        "blocked_tools": [
          "Edit",
          "Write", 
          "MultiEdit",
          "NotebookEdit"
        ],
        "parameter_patterns": {
          "allowed": [
            "^/.*\\.(md|txt|json|yaml|yml|js|py|ts|html|css)$",
            "^\\w+\\s+(show|list|status|version|help)\\b",
            "^(ls|cat|head|tail|grep|find|which|pwd)\\b"
          ],
          "blocked": [
            "\\b(rm|delete|drop|truncate)\\b",
            "^\\w*\\s*(>|>>)\\s*",
            "\\b(chmod|chown|sudo)\\b"
          ]
        },
        "path_patterns": {
          "allowed": [
            "^/.*/(src|docs|config|tests?)/.*$",
            "^/.*\\.(md|txt|json|yaml|yml|log)$",
            "^/tmp/.*$"
          ],
          "blocked": [
            "^/etc/.*$",
            "^/var/log/.*$",
            "^/.*\\.env$",
            "^/.*/\\.git/.*$"
          ]
        },
        "context_requires": [
          "read_only_operation",
          "information_gathering"
        ],
        "enforcement": "allow"
      },
      
      "qa": {
        "allowed_tools": [
          "Read",
          "Grep",
          "Glob", 
          "WebSearch",
          "WebFetch"
        ],
        "blocked_tools": [
          "Edit",
          "Write",
          "MultiEdit",
          "NotebookEdit",
          "Bash"
        ],
        "parameter_patterns": {
          "allowed": [
            "^/.*\\.(md|txt|json|yaml|yml|js|py|ts|html|css)$",
            "\\b(what|how|why|when|where|explain|describe)\\b"
          ],
          "blocked": [
            "\\b(fix|change|update|modify|create|delete)\\b",
            "^\\w*\\s*(>|>>|\\|)\\s*"
          ]
        },
        "path_patterns": {
          "allowed": [
            "^/.*/(src|docs|examples|tests?)/.*$",
            "^/.*\\.(md|txt|json|yaml|yml)$"
          ],
          "blocked": [
            "^/.*\\.env$",
            "^/.*/node_modules/.*$",
            "^/.*/\\.git/.*$"
          ]
        },
        "context_requires": [
          "question_answering",
          "explanation_context"
        ],
        "enforcement": "allow"
      },
      
      "planning": {
        "allowed_tools": [
          "Read",
          "Grep",
          "Glob",
          "Write"
        ],
        "blocked_tools": [
          "Edit",
          "MultiEdit",
          "NotebookEdit"
        ],
        "parameter_patterns": {
          "allowed": [
            "^/.*/agenttasks/.*\\.agenttask\\.yaml$",
            "^/.*/stories/.*\\.md$",
            "\\b(plan|design|architect|break\\s+down)\\b"
          ],
          "blocked": [
            "^/.*/src/.*\\.(js|py|ts|java|go|rs)$",
            "\\b(implement|execute|deploy)\\b"
          ]
        },
        "path_patterns": {
          "allowed": [
            "^/.*/agenttasks/.*$",
            "^/.*/stories/.*$", 
            "^/.*/docs/.*$",
            "^/.*\\.(md|yaml|yml)$"
          ],
          "blocked": [
            "^/.*/src/.*\\.(js|py|ts|java|go|rs)$",
            "^/.*/(build|dist|target)/.*$"
          ]
        },
        "context_requires": [
          "agenttask_context",
          "architectural_planning"
        ],
        "enforcement": "allow"
      },
      
      "work": {
        "allowed_tools": [],
        "blocked_tools": [
          "Edit",
          "Write", 
          "MultiEdit",
          "NotebookEdit",
          "Bash"
        ],
        "parameter_patterns": {
          "allowed": [],
          "blocked": [
            ".*"
          ]
        },
        "path_patterns": {
          "allowed": [],
          "blocked": [
            ".*"
          ]
        },
        "context_requires": [
          "agenttask_context",
          "agent_execution"
        ],
        "enforcement": "require_prb_context"
      }
    },
    
    "defaults": {
      "enforcement": "warn",
      "unknown_intent": "research"
    },
    
    "overrides": {
      "debug_mode": false,
      "strict_mode": true
    }
  }
}