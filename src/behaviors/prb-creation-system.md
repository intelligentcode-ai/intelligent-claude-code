# PRB Creation System

**MANDATORY:** All PRB and work item creation via main agent with template compliance and placeholder resolution.

## Imports
@./shared-patterns/template-enforcement.md
@./shared-patterns/template-loading.md
@./shared-patterns/memory-operations.md
@./shared-patterns/context-validation.md
@./shared-patterns/behavioral-decision-matrix.md
@./shared-patterns/best-practices-integration.md

## Automatic PRB Generation

### Real-Time Work Detection & Instant PRB Creation
**CRITICAL:** System operates in continuous detection mode with ZERO manual PRB creation:
- **Work intent triggers immediate PRB generation**
- **Pattern recognition distinguishes work vs information requests**
- **Complexity scoring auto-selects optimal template**
- **Full project context gathered and embedded automatically**
- **All placeholders resolved, no runtime dependencies**
- **PRBs generated with complete Task tool context**

### Enhanced Automatic Detection Patterns
**GUARANTEED PRB CREATION:**
- **Implementation**: implement, create, build, develop, code, program, write
- **Modification**: fix, update, modify, change, refactor, optimize, enhance
- **@Role Work**: @Developer implement auth, @AI-Engineer optimize behavior
- **Story Processing**: break down STORY-001, implement user authentication
- **Operations**: deploy, configure CI/CD, setup monitoring, provision resources
- **Maintenance**: clean deprecated code, remove unused files, archive data

**INTELLIGENT NON-TRIGGERS:**
- **Query**: show, display, read, list, check, analyze, examine, explain, describe
- **Status**: what's the status, current progress, ongoing work
- **Planning**: should we, what if, how about, what's the best approach
- **@Role Consultations**: @Role what would you recommend, how would you handle
- **Knowledge**: explain concept, describe process, define terminology

## Core Creation Rules

### Main Agent Only
**CRITICAL:** ALL work item creation MUST happen in main agent context:
- Stories, Bugs, EPICs, PRBs creation
- Template resolution with full context
- Configuration hierarchy access
- Complete project context gathering

**BLOCKED:** AGENTS CANNOT create work items due to isolated context limitations.

### Template Requirements
**MANDATORY:** Every PRB MUST use appropriate template from template hierarchy:
- `nano-prb-template.yaml` (0-2 points): Simple changes
- `tiny-prb-template.yaml` (3-5 points): Single-file work
- `medium-prb-template.yaml` (6-15 points): Multi-file features
- `large-prb-template.yaml` (16-30 points): Complex coordination
- `mega-prb-template.yaml` (30+ points): System-wide changes

### Placeholder Resolution
**COMPLETE RESOLUTION REQUIRED:**
- ALL placeholders resolved at generation time
- NO runtime config lookups
- Configuration values embedded in PRB
- Self-contained execution context

## Creation Process

### Lightning-Fast Automatic Generation Pipeline
**SEAMLESS 13-STEP INSTANT AUTOMATION WITH SEQUENTIAL THINKING:**
1. **Detection**: Real-time parsing with NLP pattern recognition
2. **Intent Classification**: Work vs information classification
3. **Context Assembly**: Complete project context loading
4. **Memory Integration**: Auto-search memory for applicable patterns
4b. **Best-Practices Integration**: Auto-search best-practices for relevant standards
5. **Sequential Thinking**: ALWAYS apply sequential thinking with project context for ALL work requests
6. **Complexity Calculation**: Enhanced scoring algorithm with sequential analysis
7. **Auto-Breakdown**: If >15 points, intelligent decomposition with sequential thinking
8. **Template Selection**: Complexity score mapping to optimal template
9. **Template Loading**: Complete template structure loaded
10. **Configuration Resolution**: Full config hierarchy with actual values
11. **Placeholder Elimination**: Replace ALL placeholders with actual values
12. **Context Embedding**: Complete project context embedded with sequential thinking results
13. **Quality Validation**: ZERO placeholders, complete sections verified

### Automatic Context Integration
**PRBs AUTOMATICALLY INCLUDE:**
- **Project Context**: System nature, project root, constraints from CLAUDE.md
- **Configuration Values**: All relevant settings from config hierarchy
- **Critical Files**: Relevant files with actual content samples and purposes
- **Memory Patterns**: Applicable learnings and successful patterns
- **Best-Practices**: Relevant standards, guidelines, and quality patterns
- **User Requirements**: Clear requirements with success criteria and scope limits
- **Role Assignment**: Appropriate specialist roles based on work type

### Size Enforcement & Validation
**AUTO-BREAKDOWN:** If complexity >15 points, automatically break into smaller PRBs ≤15 points each
**MANDATORY CHECKS:** Template compliance, zero placeholders, complete context, naming format, parent reference

## Creation vs Execution Separation

### Creation (Main Agent)
- Full configuration access
- Template hierarchy access
- Memory search capabilities
- Complete project context
- Placeholder resolution

### Execution (Subagent)
- PRB implementation work
- Role-based task delegation
- Code changes and file operations
- Testing and validation
- Git operations within PRB scope

## Automatic Error Handling & Recovery

### Intelligent Violation Detection & Auto-Correction
**AUTOMATIC RECOVERY PATTERNS:**
- **Work Detection Failure** → Re-analyze with enhanced pattern matching
- **Context Incomplete** → Auto-gather missing project context and configuration
- **Wrong Template** → Recalculate complexity, auto-select correct template
- **Size Violations** → Automatic logical breakdown into multiple ≤15 point PRBs
- **Format Violations** → Auto-apply naming standards and compliance rules
- **Missing Dependencies** → Auto-identify and include prerequisite work items

### Blocking Patterns (IMMEDIATE STOP)
**HARD BLOCKS:**
- Subagent PRB creation → "CREATION BLOCKED: Work items must be created by main agent"
- Manual PRB without templates → "TEMPLATE REQUIRED: PRB creation without template FORBIDDEN"
- Unresolved placeholders → "PLACEHOLDER UNRESOLVED: All placeholders must be resolved"
- Runtime config dependencies → "RUNTIME LOOKUP FORBIDDEN: All config must be embedded"

---
*Comprehensive PRB and work item creation system*