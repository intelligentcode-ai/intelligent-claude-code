# Integration Layer Module

**PRINCIPLE:** INTELLIGENT ROUTING + MEMORY INTEGRATION + TOOL FALLBACK + ACTIVE LEARNING

## ACTIVE MEMORY & LEARNING ENGINE

**AUTO-TRIGGERS:** Score change → Learning capture • Pattern detected → Memory storage • Error → Team learning • Success → Best practice
**ENFORCEMENT:** Memory available → Must use • Learning event → Must capture • Pattern → Must store

## Capability-Based Routing

**CAPABILITIES:** Analysis • Architecture • Implementation • Testing • Security • Deployment • Design • Documentation
**ROUTING:** Task → Analyze capabilities → Score roles → Assign best match → Execute with fallback
**SCORING:** Direct +100 • Ultra-experienced always • Specialization +25

## Memory Bank with Exponential Aging

**AGING:** Relevance = Initial × e^(-0.1 × Days) → Archive <0.3 → Promote >0.7
**STORAGE:** MCP Memory (primary) → learning-callouts.md (fallback) → Auto-detect availability
**ENTITIES:** Learning-Events • Pattern-Clusters • Performance-Metrics • Knowledge-Base
**WORKFLOW:** Capture → Timestamp → Age daily → Cluster patterns → Archive/Promote

### MCP Memory Operations
**CREATE:** mcp__memory__create_entities → Store learnings/patterns
**RELATE:** mcp__memory__create_relations → Link knowledge clusters  
**UPDATE:** mcp__memory__add_observations → Add insights
**SEARCH:** mcp__memory__search_nodes → Query patterns

## Quality Gates & Dynamic Integration

**GATES:** Analysis → Architecture → Implementation → Testing → Security → ANY role combo
**ENFORCEMENT:** Gate fail → Auto-correct → Re-execute → Escalate if needed
**SPECIALISTS:** Auto-register → Add capabilities → Score/select → Integrate seamlessly

## Memory Integration Triggers

**AUTO-CAPTURE:** Preferences • Context • Expertise • Patterns • Decisions • Tech • Process • Quality • Learning
**ENFORCEMENT:** Event detected → Create entity → Add observations → Create relations → Store knowledge
**ROLE-SPECIFIC:** PM (context/decisions) • Architect (patterns/tech) • Developer (code/bugs) • Security (threats/compliance)

## Tool Fallback Logic

**HIERARCHY:** Context7 (docs) → Brave Search (current) → Built-in tools → Manual guidance
**AUTO-FALLBACK:** Tool unavailable → Try next → Maintain functionality → Notify user
**ENFORCEMENT:** Docs needed → Must try Context7 • Current info → Must try Brave • Always graceful degradation

## Active Learning System

**TRIGGERS:** -10pts P → Team replacement • Score changes → Learning callout • Errors → Capture pattern
**CAPTURE:** Event → Create learning → Add to memory → Apply aging → Archive/promote
**ENFORCEMENT:** Learning opportunity → MUST capture → Store in memory → Share with team

## Summary

**ACTIVE:** Memory triggers • Tool fallback • Learning capture • Capability routing • Quality gates
**ENFORCEMENT:** All events monitored → Auto-capture → Auto-fallback → Auto-learn → Continue workflow